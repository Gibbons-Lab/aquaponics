---
title: "General plots"
output: html_notebook
---

We will start by loading the data set:

```{r}
library(mbtools)

ps <- readRDS("data/taxonomy.rds")
ps
```

## Ordination

```{r, fig.width=6, fig.height=4}
ord <- ordinate(ps, method="PCoA")
plot_ordination(ps, ord, color="environment", shape="inoculate", label="isb_id") + theme_bw()
ggsave("figures/pcoa.pdf")
```

## Richness

```{r, fig.width=8, fig.height=3}
plot_richness(ps, x="sample_set", color="environment", shape="inoculate", 
              measures=c("Observed", "Shannon")) + theme_bw()
```

## Heatmaps

```{r, fig.height=20, fig.width=6}
library(pheatmap)

counts <- as.matrix(taxa_count(ps)) %>% filter_counts()
pheatmap(log10(t(counts) + 1))
```

